project_name: rewinged

builds:
  - id: windows
    hooks:
      pre:
        - cmd: go generate # creates versioninfo resource file used by windows build
          output: true
      post:
        - cmd: '/bin/sh -c "rm resource.syso || true"' # ensure resource file meant for windows is gone or it leads to 'architecture incompatible' compile error on linux
          output: true
    ldflags:
      - -s -w # do not include debug symbols in executables
      - -X 'main.version={{.Version}}' # set version information in-program
      - -X 'main.commit={{.ShortCommit}}' # set commit information in-program
      - -X 'main.releaseMode=true' # set gin to releaseMode
    goos: [windows]
    goarch: [amd64]
    goamd64: [v1]
  - id: linux
    hooks:
      pre:
        - cmd: '/bin/sh -c "rm resource.syso || true"' # ensure resource file meant for windows is gone or it leads to 'architecture incompatible' compile error
          output: true
    ldflags:
      - -s -w # do not include debug symbols in executables
      - -X 'main.version={{.Version}}' # set version information in-program
      - -X 'main.commit={{.ShortCommit}}' # set commit information in-program
      - -X 'main.releaseMode=true' # set gin to releaseMode
    goos: [linux]
    goarch: [amd64]
    goamd64: [v1]

release:
  draft: true

